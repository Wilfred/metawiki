<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Wikicircle - A truly editable website</title>

        <link rel="stylesheet" href="/serve/css/codemirror.css">
        <link rel="stylesheet" href="/serve/js/wikicircle/wikicircle.css">
    </head>
    <body>
        <div id="content">
            <h2>Oh no!</h2>
            <p>If you can see this, something has gone wrong.
            </p>

            <p>If you've turned JS off, please enable it. JS is fundamental
                to how this metawiki is designed.</p>

            <p>If JS is available, we've crashed. Please take a look
                at your browser console. There's
                a <a href="/safe">safe
                mode</a> where you can look at content without clientside JS.
            </p>
        </div>
        
        <script type="text/template" id="page-template">
            <a href="/">Home</a> <a href="/#edit?{{path}}">Edit</a>
            <hr>
            {{content}}
        </script>
        
        <script type="text/template" id="page-missing-template">
            <h2>No such page: {{path}}</h2>
            
            <p>
                There's no such page '{{path}}'. Would you like to
                <a href="#new?{{path}}">create it</a>?
            </p>
        </script>

        <script type="text/template" id="editor-template">
            <h2>{{heading}}</h2>
            <form>
                <input type="text" name="path" value="{{path}}">
                <select name="mimeType">
                    <!-- this should be a database value, not hard-coded. -->
                    <option value="text/x-markdown" {{#ifEqual mimeType "text/x-markdown"}}selected{{/ifEqual}}>
                        Markdown
                    </option>
                    <option value="application/javascript" {{#ifEqual mimeType "application/javascript"}}selected{{/ifEqual}}>
                        JavaScript
                    </option>
                    <option value="text/html" {{#ifEqual mimeType "text/html"}}selected{{/ifEqual}}>
                        HTML
                    </option>
                    <option value="text/css" {{#ifEqual mimeType "text/css"}}selected{{/ifEqual}}>
                        CSS
                    </option>
                </select>
                <textarea id="editor">{{content}}</textarea>
                {{#ifEqual mimeType "application/javascript"}}
                <input type="submit" value="Execute" name="execute">
                {{/ifEqual}}
                <input type="submit" value="Save">
                <input type="submit" value="Save and continue editing" name="save-continue">                    
            </form>
        </script>

        <script src="/serve/js/requirejs/require.js"
                data-main="/serve/js/wikicircle/app.js" async></script>

    </body>
</html>
